{% extends 'base.html' %}

{% load static %}

{% block linked_files %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/buttons.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/prjdash/project-dash.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/prjdash/project-dash-accordion.css' %}">
{% endblock %}

{% block breadcrumbs %}
		<div class="breadcrumbs">
			{{ _('Project dashboard') }}
		</div>
{% endblock %}

{% block content %}

<div class="main-container">
	{% for customer in customers %}
	  {% if customer.id == focus.customer_id %}
		<button class="accordion active" value="{{customer.id}}">{{customer.name}}</button>
		<div class="panel panel-active">
	  {% else %}	
		<button class="accordion" value="{{customer.id}}">{{customer.name}}</button>
		<div class="panel">
	  {% endif %}
		<!-- div class="panel"> -->
			<div class="scont">
				<table class = "tb">
					<thead class="tb">
						<th></th>
						<th class="tb">Project</th>
						<th>Comment</th>
						<th style="width:80px">Date created</th>
						<th>Actions</th>
					</thead>
	   			    {% if modify == False %}
						{% include 'prjdash/project_form.html' %}
					{% endif %}
					
					{% for project in customer.projects %}
						{% if modify == True %}
							{% include 'prjdash/project_form.html' %}
						{% else %}
							{% include 'prjdash/project_line.html' %}
						{% endif %}
					{% endfor %}
					<tfoot>
					</tfoot>
				</table>
			</div>
		</div>
	{% endfor %}
   	<script>
		var acc = document.getElementsByClassName("accordion");
		var i;
		
		for (i = 0; i < acc.length; i++) {
		  acc[i].addEventListener("click", function() {
			 //this.style.borderBottomRightRadius = 0;			 
		    this.classList.toggle("active");
		    var panel = this.nextElementSibling;
		    panel.classList.toggle("panel-active")
		    if (panel.style.maxHeight){
		      panel.style.maxHeight = null;
		    } else {
		      panel.style.maxHeight = panel.scrollHeight + "px";
		    }
		    anchor = document.getElementById("cust_" + this.value)
		    anchor.nextElementSibling.value = this.value
		    
		    // Closing all other open sections 
			 var btns = document.getElementsByClassName("accordion")
			 for (k = 0; k < btns.length; k++) {
				var btn = btns[k]			 
			 	if (btn != this) {
			 		btn.classList.remove("active")
			 		var xpanel = btn.nextElementSibling;
			 		xpanel.style.maxHeight = null;
			 		xpanel.classList.remove("panel-active")
			 	}
			 };
		  });
		}		
	</script>		
</div>
{% endblock %}